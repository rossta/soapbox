Simple=(function(j,e,h){e.fn.dl=e.fn.delegate;e.fn.tr=e.fn.trigger;e.fn.nx=e.fn.next;e.fn.pv=e.fn.prev;e.fn.tg=e.fn.toggle;var d=j,i="prototype",g=document,f="<a href='#'></a>",b={init:function(){var k=new d.Sx();k.add(d.Au).add(d.Sw).add(d.We).add(d.Ky).init();Simple.app=k;return k}},c=function(){var k=h.console;if(k&&k.log&&typeof k.log.apply=="function"){k.log.apply(k,arguments)}},a=function(k){return throwdown(k).toH()};d.Sx=function(){this.ms=[]};d.Sx[i]={add:function(l){var k=new l();k.sx=this;this.ms.push(k);return this},init:function(){var k=this;k.archive=new d.Archive();k.forEach("init");e("a.tg").bind("click",function(){k.forEach("tg")});k.bind("tg.smp",function(){k.forEach("tg")});return k},tr:function(k,l){return e(g).tr(k,l)},bind:function(k,l){return e(g).bind(k,l)},forEach:function(k){e.map(this.ms,function(l){if(typeof l[k]=="function"){l[k]()}})},lo:function(l){l=l||"demo";var n=this,m=n.rt(l),o=n.rt("spb");if(!m){m=[];if(l=="demo"){m=["# Create sls","with text","<h2>html</h2>","# and (some) markdown","# Any questions?"]}}if(!o){o=[l]}if(e.inArray(l,o)<0){o.push(l)}n.store("spb",o);n.k=l;n.s=m;return m},rt:function(l){return this.archive.rt(l)},get:function(k){return this.s[k]},save:function(m,l){c("Saving",m,l);var k=this;k.s[m]=l;return k.store(k.k,k.s)},store:function(l,m){return this.archive.store(l,m)},all:function(n){var m=this,l=0,k=m.s[l];while(k){n({num:l,mk:k});k=m.s[++l]}return m},clear:function(){return this.archive.clear()}};d.Au=function(l){l=l||"#au";var k=this;k.sel=l;k.$sel=e(l);k.$pre=k.$sel.find("#pre");k.$ta=k.$sel.find("textarea");k.$pgs=k.$sel.find("#pgs")};d.Au[i]={init:function(){var k=this;k.hide();k.listen()},listen:function(){var k=this;k.$sel.dl("textarea","keyup change",function(){var m=e(this),l=m.val();slId=m.attr("name");e("#"+slId).html(a(l));k.sx.save(slId.split("_")[1],l)}).dl("#pre","click",function(){e(this).nx().find("textarea").focus()}).dl("a.pl","click",function(){k.sx.tr("pl.smp");return false}).dl("a.ins","click",function(){k.ins(k.$pre.children().length,"# New Slide");return false}).dl("a.nw","click",function(){k.createNew();return false}).dl("#pgs a","click",function(){k.display(parseInt(e(this).html(),10)-1);return false}).dl(".hm","click",function(){return h.location.reload()});k.sx.bind("nw.smp",function(){k.createNew()}).bind("edit.smp",function(){k.lo(k.sx.k)})},hide:function(){return this.$sel.hide()},show:function(){return this.$sel.show()},createNew:function(){var k=this,l=prompt("Save New Slideshow As...");k.lo(l);k.$pre.empty();k.$pgs.empty();k.ins(0,"# New Slideshow");k.show()},display:function(k,n){var l=this,m="sl_"+k;n=n||l.sx.get(k);e("div.sl").hide();e("[id$="+m+"]").show();l.$pgs.children().removeClass("cur").filter(":eq("+k+")").addClass("cur");l.$ta.attr("name",m).val(n);l.$ta.change();return l},ins:function(k,m){var l=this;e("<div></div>").attr("id","sl_"+k).attr("class","sl ca pdg").html(a(m)).appendTo(l.$pre).hide();e(f).html(k+1).appendTo(l.$pgs);l.sx.save(k,m);l.display(k);return l},tg:function(){return this.$sel.tg()},lo:function(l){var m=this;m.sx.lo(l);m.sx.all(function(k){m.ins(parseInt(k.num,10),k.mk)});m.display(0)}};d.Sw=function(l){l=l||"#sw";var k=this;k.sel=l;k.$sel=e(l);k.$sc=k.$sel.find(".sc");k.$ex=k.$sel.find(".ex")};d.Sw[i]={init:function(){var k=this;k.hide();k.listen()},listen:function(){var k=this;k.$sel.dl("a.ex","click",function(){k.sx.tr("stop.smp")});k.sx.bind("pl.smp",function(){k.pl()}).bind("loed.smp",function(m,l){k.show()}).bind("nx.smp",function(){k.nx()}).bind("pv.smp",function(){k.pv()})},hide:function(){this.$ex.hide();return this.$sel.hide()},show:function(){this.$ex.show();return this.$sel.show()},tg:function(){this.$ex.tg();return this.$sel.tg()},pl:function(){var k=this;k.$sc.empty();k.sx.all(function(l){e("<div></div>").html(a(l.mk)).appendTo(k.$sc).hide()});k.$sc.children().addClass("sl").first().cl();k.sx.tr("loed.smp")},nx:function(){var k=this,l=k.$sc.children(":visible").hide().nx();if(l.length){l.cl()}else{k.sx.tr("stop.smp").tr("tg.smp")}},pv:function(){var k=this,l=k.$sc.children(":visible").hide().pv();if(l.length){l.cl()}else{k.sx.tr("stop.smp").tr("tg.smp")}}};d.We=function(l){l=l||"#we";var k=this;k.sel=l;k.$sel=e(l);k.$sc=k.$sel.find(".sc");k.spb=[]};d.We[i]={init:function(){var k=this;k.show();k.$sel.dl("a.pl","click",function(){k.sx.lo(e(this).text());k.hide();k.sx.tr("edit.smp").tr("pl.smp")})},hide:function(){return this.$sel.hide()},show:function(){var k=this;k.sx.lo();k.spb=k.sx.rt("spb");e.map(k.spb,function(l){e(f).html(l).addClass("pl").appendTo(k.$sc)});e("<hr />").appendTo(k.$sc);e(f).html("new").appendTo(k.$sc).click(function(){k.sx.tr("nw.smp");k.hide()});return k.$sel.show()}};d.Archive=function(){this.db=d.Archive.connection};d.Archive[i]={rt:function(l){var m=this.db[l];if(m){return JSON.parse(m)}else{return null}},store:function(l,m){this.db[l]=JSON.stringify(m);return this},clear:function(){try{this.db.clear()}catch(k){d.Archive.connection=h.localStorage||{}}}};d.Archive.connection=h.localStorage||{};d.Ky=function(){var k=this;k.EDIT="edit";k.SHOW="show";k.context=k.EDIT};d.Ky[i]={ks:{space:32,left:37,right:39,esc:27},init:function(){var k=this,l=k.ks;k.sx.bind("pl.smp",function(){k.context=k.SHOW}).bind("stop.smp",function(){k.context=k.EDIT}).bind("keydown",function(n){var m=n.keyCode;switch(k.context){case k.EDIT:c(m);break;case k.SHOW:switch(m){case l.space:c("space");break;case l.left:k.sx.tr("pv.smp");break;case l.right:k.sx.tr("nx.smp");break;case l.esc:k.sx.tr("stop.smp");k.sx.tr("tg.smp");break;default:c(m);break}break}})}};e.fn.cl=function(){return this.css({display:"table-cell","vertical-align":"middle"})};return e.extend(d,b)})({},jQuery,window);